CREATE TABLE featured_pair (id BIGINT AUTO_INCREMENT, beer_id BIGINT NOT NULL, movie_id BIGINT NOT NULL, meta VARCHAR(255), INDEX beer_id_idx (beer_id), INDEX movie_id_idx (movie_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE beer (id BIGINT AUTO_INCREMENT, author BIGINT NOT NULL, label VARCHAR(255) NOT NULL, style BIGINT NOT NULL, brewery BIGINT NOT NULL, image VARCHAR(255), notes TEXT, rating DECIMAL(18,1), abv VARCHAR(255), ibu VARCHAR(255), created_at DATETIME, updated_at DATETIME, INDEX author_idx (author), INDEX style_idx (style), INDEX brewery_idx (brewery), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE movie (id BIGINT AUTO_INCREMENT, author BIGINT NOT NULL, image VARCHAR(255), title VARCHAR(255) NOT NULL, rating DECIMAL(18,1), year INT NOT NULL, nfid VARCHAR(255), runtime INT, synopsis TEXT, nflink VARCHAR(255), nfsimilar VARCHAR(255), created_at DATETIME, updated_at DATETIME, INDEX author_idx (author), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE brewery (id BIGINT AUTO_INCREMENT, name VARCHAR(255) NOT NULL, country VARCHAR(255) NOT NULL, image VARCHAR(255), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE style (id BIGINT AUTO_INCREMENT, style VARCHAR(255) NOT NULL, notes TEXT, image VARCHAR(255), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user (id BIGINT AUTO_INCREMENT, username VARCHAR(255) NOT NULL UNIQUE, password VARCHAR(255) NOT NULL, role VARCHAR(255) DEFAULT 'normal' NOT NULL, email VARCHAR(255) NOT NULL, token VARCHAR(32), nftoken VARCHAR(255), nfsecret VARCHAR(255), nfauth TINYINT(1) DEFAULT '0' NOT NULL, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE genre (id BIGINT AUTO_INCREMENT, movie_id BIGINT NOT NULL, genre VARCHAR(255) NOT NULL, INDEX movie_id_idx (movie_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE featured_pair ADD FOREIGN KEY (movie_id) REFERENCES movie(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE featured_pair ADD FOREIGN KEY (beer_id) REFERENCES beer(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE beer ADD FOREIGN KEY (style) REFERENCES style(id);
ALTER TABLE beer ADD FOREIGN KEY (brewery) REFERENCES brewery(id);
ALTER TABLE beer ADD FOREIGN KEY (author) REFERENCES user(id);
ALTER TABLE movie ADD FOREIGN KEY (author) REFERENCES user(id);
ALTER TABLE genre ADD FOREIGN KEY (movie_id) REFERENCES movie(id) ON UPDATE CASCADE ON DELETE CASCADE;
